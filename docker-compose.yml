services:
  se.plan:
    build:
      dockerfile: ./Dockerfile
      args:
        - GIT_COMMIT=${GIT_COMMIT:-""}
    image: "openforis/seplan"
    container_name: se.plan
    volumes:
      - "${USERS_HOME_PATH:-/home}:/userHomes"
      - "${EE_CREDENTIALS_PATH:-${HOME}/.config/earthengine/credentials}:/root/.config/earthengine/credentials"
    environment:
      SEPAL_HOST: "${SEPAL_HOST}"
      FORWARDED_ALLOW_IPS: "*"
    healthcheck:
      test: ["CMD", "nc", "-z", "localhost", "80"]
      timeout: 60s
      interval: 1s
      retries: 60
    networks:
      - sepal
    restart: always
networks:
  sepal:
    external: true